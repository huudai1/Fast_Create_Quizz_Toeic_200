<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="quiz.css">
</head>
<body class="bg-gray-100 font-sans">
    <div id="download-notice" class="fixed top-4 right-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 hidden">
        <p class="font-bold">Admin Chú Ý</p>
        <p>HÃY TẢI ĐỀ XUỐNG TRƯỚC KHI THOÁT!</p>
    </div>

    <div id="welcome-screen" class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-4">Quiz App</h1>
        <p>Hãy dùng máy tính để có trải nghiệm tốt nhất!</p>
        <p id="notification-welcome" class="text-red-500 mb-4"></p>
        <div class="space-y-4">
            <button onclick="showAdminLogin()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Đăng nhập Admin</button>
            <button onclick="showStudentLogin()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Đăng nhập Học sinh</button>
        </div>
    </div>

    <div id="admin-login" class="container mx-auto p-4 hidden">
        <h1 class="text-3xl font-bold mb-4">Đăng nhập Admin</h1>
        <p id="notification-admin-login" class="text-red-500 mb-4"></p>
        <form id="admin-login-form" class="space-y-4">
            <div>
                <label for="admin-username" class="block text-lg">Tên đăng nhập:</label>
                <input id="admin-username" type="text" class="border p-2 rounded w-full" required value="admin">
            </div>
            <div>
                <label for="admin-password" class="block text-lg">Mật khẩu:</label>
                <input id="admin-password" type="password" class="border p-2 rounded w-full" required>
            </div>
            <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Đăng nhập</button>
        </form>
        <button onclick="showWelcomeScreen()" class="mt-4 bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Quay lại</button>
    </div>

    <div id="student-login" class="container mx-auto p-4 hidden">
        <h1 class="text-3xl font-bold mb-4">Đăng nhập Học sinh</h1>
        <p id="notification-student-login" class="text-red-500 mb-4"></p>
        <form id="student-name-form" class="space-y-4">
            <div>
                <label for="student-name" class="block text-lg">Tên:</label>
                <input id="student-name" type="text" class="border p-2 rounded w-full" required>
            </div>
            <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Đăng nhập</button>
        </form>
        <button onclick="showWelcomeScreen()" class="mt-4 bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Quay lại</button>
    </div>

    <div id="quiz-list-screen" class="container mx-auto p-4 hidden">
        <div class="flex justify-between items-center mb-4">
            <h1 class="text-3xl font-bold">Danh sách đề thi</h1>
            <div>
                <label class="switch">
                    <input type="checkbox" id="toggle-dark-mode">
                    <span class="slider"></span>
                </label>
                <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 ml-4">Đăng xuất</button>
            </div>
        </div>
        <p id="notification" class="text-red-500 mb-4"></p>
        <p id="quiz-status" class="text-lg mb-4"></p>
        <p id="participant-count" class="text-lg mb-4"></p>
        <p id="submitted-count" class="text-lg mb-4"></p>
        
        <div id="admin-options" class="space-y-4 mb-4 hidden">
            <button onclick="createNewQuiz()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Tạo đề thi mới</button>
            <button onclick="showUploadQuizzes()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Tải lên đề thi</button>
            <button onclick="clearDatabase()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Xóa database cũ</button>
            <button onclick="showStatistics()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">Xem thống kê</button>
        </div>
        <div id="admin-controls" class="space-x-4 mb-4 hidden">
            <button id="assignBtn" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 hidden">Giao bài</button>
            <button id="directTestBtn" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 hidden">Kiểm tra trực tiếp</button>
        </div>
        <div id="part-visibility-controls" class="my-4 p-4 border rounded hidden">
            <h3 class="text-lg font-semibold mb-2">Ẩn/Hiện các phần thi</h3>
            <div class="flex flex-wrap gap-2">
                <button id="toggle-part-1" onclick="togglePartVisibility(1)" class="part-toggle-btn">Part 1</button>
                <button id="toggle-part-2" onclick="togglePartVisibility(2)" class="part-toggle-btn">Part 2</button>
                <button id="toggle-part-3" onclick="togglePartVisibility(3)" class="part-toggle-btn">Part 3</button>
                <button id="toggle-part-4" onclick="togglePartVisibility(4)" class="part-toggle-btn">Part 4</button>
                <button id="toggle-part-5" onclick="togglePartVisibility(5)" class="part-toggle-btn">Part 5</button>
                <button id="toggle-part-6" onclick="togglePartVisibility(6)" class="part-toggle-btn">Part 6</button>
                <button id="toggle-part-7" onclick="togglePartVisibility(7)" class="part-toggle-btn">Part 7</button>
            </div>
        </div>
        <div id="quiz-list" class="space-y-4"></div>
        <table id="results-table" class="w-full border-collapse hidden mt-4">
            <thead>
                <tr class="bg-gray-200 dark:bg-gray-700 text-black dark:text-white">
                    <th class="border p-2">Tên</th>
                    <th class="border p-2">Điểm</th>
                    <th class="border p-2">Thời gian nộp</th>
                </tr>
            </thead>
            <tbody id="results-body"></tbody>
        </table>
    </div>
    
    <div id="quiz-container" class="container mx-auto p-4 hidden">
        <h1 class="text-3xl font-bold mb-4">Bài thi</h1>
        <p id="notification-quiz" class="text-red-500 mb-4"></p>
        <p id="timer" class="text-lg mb-4 hidden"></p>
        <audio id="audio" controls class="mb-4 hidden">
            <source id="audio-source" src="" type="audio/mpeg">
        </audio>
        <div class="split-container">
            <div class="image-section" id="image-display">
                <h3 class="text-lg font-semibold mb-2">Part 1</h3>
            </div>
            <div class="question-section">
                <form id="quizForm" class="space-y-4">
                    <div id="quiz-part1">
                        <h2 class="text-2xl font-semibold mb-2">Part 1</h2>
                        <div id="section1" class="space-y-4"></div>
                    </div>
                    <div id="quiz-part2" class="hidden">
                        <h2 class="text-2xl font-semibold mb-2">Part 2</h2>
                        <div id="section2" class="space-y-4"></div>
                    </div>
                    <div id="quiz-part3" class="hidden">
                        <h2 class="text-2xl font-semibold mb-2">Part 3</h2>
                        <div id="section3" class="space-y-4"></div>
                    </div>
                    <div id="quiz-part4" class="hidden">
                        <h2 class="text-2xl font-semibold mb-2">Part 4</h2>
                        <div id="section4" class="space-y-4"></div>
                    </div>
                    <div id="quiz-part5" class="hidden">
                        <h2 class="text-2xl font-semibold mb-2">Part 5</h2>
                        <div id="section5" class="space-y-4"></div>
                    </div>
                    <div id="quiz-part6" class="hidden">
                        <h2 class="text-2xl font-semibold mb-2">Part 6</h2>
                        <div id="section6" class="space-y-4"></div>
                    </div>
                    <div id="quiz-part7" class="hidden">
                        <h2 class="text-2xl font-semibold mb-2">Part 7</h2>
                        <div id="section7" class="space-y-4"></div>
                    </div>
                    <div class="flex space-x-4 sticky bottom-0 bg-gray-100 p-4">
                        <button type="button" onclick="prevQuizPart(currentQuizPart)" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Phần trước</button>
                        <button type="button" onclick="nextQuizPart(currentQuizPart)" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Phần tiếp theo</button>
                        <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Nộp bài</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div id="result-screen" class="container mx-auto p-4 hidden">
        <h1 class="text-3xl font-bold mb-4">Kết quả</h1>
        <p id="result-score" class="text-lg mb-2"></p>
        <p id="result-time" class="text-lg mb-2"></p>
        <div class="flex space-x-4">
            <button onclick="showReviewAnswers()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Xem đáp án</button>
            <button onclick="showWelcomeScreen()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Quay lại</button>
        </div>
    </div>

    <div id="heartbeat-indicator" class="fixed bottom-4 right-4 z-50 text-2xl hidden">
        ❤️
    </div>
    <div id="loading-screen">
        <div id="loading-text">Get Ready!</div>
        <div id="loading-spinner"></div>
    </div>

    <script src="quiz.js"></script>
</body>
</html>